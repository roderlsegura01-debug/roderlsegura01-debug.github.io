<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FiberTech Registro - Plataforma de Gestión Técnica</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'fiber-blue': '#2563eb',
                        'fiber-dark': '#1e293b',
                        'fiber-gray': '#64748b'
                    }
                }
            }
        }
    </script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #2563eb 0%, #1e293b 100%);
        }
        .card-shadow {
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .tech-pattern {
            background-image: 
                radial-gradient(circle at 25px 25px, rgba(255,255,255,0.1) 2px, transparent 0),
                radial-gradient(circle at 75px 75px, rgba(255,255,255,0.1) 2px, transparent 0);
            background-size: 100px 100px;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Navigation -->
    <nav class="gradient-bg text-white shadow-lg" id="navbar" style="display: none;">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-white rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-fiber-blue" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold">FiberTech Registro</h1>
                        <p class="text-xs opacity-75">Gestión Técnica Profesional</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <span id="userWelcome" class="text-sm"></span>
                    <button onclick="logout()" class="bg-white/20 hover:bg-white/30 px-3 py-1 rounded-lg text-sm transition-colors">
                        Cerrar Sesión
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen gradient-bg tech-pattern flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl card-shadow p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <div class="w-16 h-16 bg-fiber-blue rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                </div>
                <h2 class="text-2xl font-bold text-fiber-dark">FiberTech Registro</h2>
                <p class="text-fiber-gray mt-2">Acceso al Sistema de Gestión</p>
            </div>
            
            <form onsubmit="handleLogin(event)" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-fiber-dark mb-2">Usuario</label>
                    <input type="text" id="username" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fiber-blue focus:border-transparent transition-all"
                           placeholder="Ingrese su usuario">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-fiber-dark mb-2">Contraseña</label>
                    <input type="password" id="password" required 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fiber-blue focus:border-transparent transition-all"
                           placeholder="Ingrese su contraseña">
                </div>
                
                <button type="submit" 
                        class="w-full bg-fiber-blue hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors">
                    Iniciar Sesión
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-xs text-fiber-gray">
                    Demo: admin/admin123 o tecnico1/tech123
                </p>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" style="display: none;">
        <!-- Sidebar -->
        <div class="flex">
            <div class="w-64 bg-fiber-dark text-white min-h-screen">
                <div class="p-6">
                    <div class="space-y-2">
                        <button onclick="showSection('dashboard')" 
                                class="w-full text-left px-4 py-3 rounded-lg hover:bg-white/10 transition-colors flex items-center space-x-3">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"/>
                            </svg>
                            <span>Dashboard</span>
                        </button>
                        
                        <button onclick="showSection('form')" 
                                class="w-full text-left px-4 py-3 rounded-lg hover:bg-white/10 transition-colors flex items-center space-x-3">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 102 0V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z"/>
                            </svg>
                            <span>Registro de Trabajo</span>
                        </button>
                        
                        <div id="adminMenu" style="display: none;">
                            <button onclick="showSection('admin')" 
                                    class="w-full text-left px-4 py-3 rounded-lg hover:bg-white/10 transition-colors flex items-center space-x-3">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z"/>
                                </svg>
                                <span>Panel Admin</span>
                            </button>
                            
                            <button onclick="showSection('users')" 
                                    class="w-full text-left px-4 py-3 rounded-lg hover:bg-white/10 transition-colors flex items-center space-x-3">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"/>
                                </svg>
                                <span>Gestión Usuarios</span>
                            </button>
                            
                            <button onclick="showSection('payroll')" 
                                    class="w-full text-left px-4 py-3 rounded-lg hover:bg-white/10 transition-colors flex items-center space-x-3">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zM14 6a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2V8a2 2 0 012-2h6zM4 14a2 2 0 002 2h8a2 2 0 002-2v-2H4v2z"/>
                                </svg>
                                <span>Nómina</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="flex-1 p-6">
                <!-- Dashboard Section -->
                <div id="dashboardSection" class="section">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-fiber-dark">Dashboard</h2>
                        <p class="text-fiber-gray">Resumen de actividades y trabajos</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-xl card-shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-fiber-gray text-sm">Trabajos Completados</p>
                                    <p class="text-2xl font-bold text-fiber-dark" id="completedJobs">12</p>
                                </div>
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl card-shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-fiber-gray text-sm">En Proceso</p>
                                    <p class="text-2xl font-bold text-fiber-dark" id="pendingJobs">5</p>
                                </div>
                                <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-yellow-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl card-shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-fiber-gray text-sm">DTAP Asignados</p>
                                    <p class="text-2xl font-bold text-fiber-dark" id="assignedDTAP">3</p>
                                </div>
                                <div class="w-12 h-12 bg-fiber-blue/10 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-fiber-blue" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                                        <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 102 0V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl card-shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-fiber-gray text-sm">Pagos Pendientes</p>
                                    <p class="text-2xl font-bold text-fiber-dark">$2,450</p>
                                </div>
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zM14 6a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2V8a2 2 0 012-2h6zM4 14a2 2 0 002 2h8a2 2 0 002-2v-2H4v2z"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Work History -->
                    <div class="bg-white rounded-xl card-shadow">
                        <div class="p-6 border-b border-gray-200">
                            <h3 class="text-lg font-semibold text-fiber-dark">Historial Reciente de Trabajos</h3>
                        </div>
                        <div class="p-6">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="text-left text-fiber-gray text-sm">
                                            <th class="pb-3">DTAP</th>
                                            <th class="pb-3">Fecha</th>
                                            <th class="pb-3">Proyecto</th>
                                            <th class="pb-3">Ubicación</th>
                                            <th class="pb-3">Estado</th>
                                            <th class="pb-3">Evidencia</th>
                                        </tr>
                                    </thead>
                                    <tbody id="workHistoryTable" class="text-sm">
                                        <!-- Work history will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Work Registration Form -->
                <div id="formSection" class="section" style="display: none;">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-fiber-dark">Registro de Trabajo</h2>
                        <p class="text-fiber-gray">Complete la información del trabajo realizado</p>
                    </div>
                    
                    <div class="bg-white rounded-xl card-shadow p-6">
                        <form onsubmit="submitWork(event)" class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-fiber-dark mb-2">DTAP</label>
                                    <select id="dtapSelect" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fiber-blue focus:border-transparent">
                                        <option value="">Seleccione DTAP</option>
                                        <option value="DTAP-001">DTAP-001 - Instalación Residencial</option>
                                        <option value="DTAP-002">DTAP-002 - Mantenimiento Empresarial</option>
                                        <option value="DTAP-003">DTAP-003 - Reparación de Red</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-fiber-dark mb-2">Fecha</label>
                                    <input type="date" id="workDate" required 
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fiber-blue focus:border-transparent">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-fiber-dark mb-2">Técnico</label>
                                    <input type="text" id="technicianName" readonly 
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 text-fiber-gray">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-fiber-dark mb-2">Terminal (TML)</label>
                                    <input type="text" id="terminal" required 
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fiber-blue focus:border-transparent"
                                           placeholder="Ej: TML-A001">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-fiber-dark mb-2">Ubicación</label>
                                <input type="text" id="location" required 
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fiber-blue focus:border-transparent"
                                       placeholder="Dirección completa del trabajo">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-fiber-dark mb-2">Proyecto</label>
                                <select id="projectSelect" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fiber-blue focus:border-transparent">
                                    <option value="">Seleccione Proyecto</option>
                                    <option value="Proyecto Alpha">Proyecto Alpha - Expansión Norte</option>
                                    <option value="Proyecto Beta">Proyecto Beta - Modernización Centro</option>
                                    <option value="Proyecto Gamma">Proyecto Gamma - Instalación Sur</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-fiber-dark mb-2">Evidencia Fotográfica</label>
                                <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-fiber-blue transition-colors">
                                    <input type="file" id="evidencePhoto" accept="image/*" class="hidden" onchange="handleFileUpload(event)">
                                    <div id="uploadArea" onclick="document.getElementById('evidencePhoto').click()" class="cursor-pointer">
                                        <svg class="w-12 h-12 text-fiber-gray mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                        </svg>
                                        <p class="text-fiber-gray">Haga clic para subir evidencia</p>
                                        <p class="text-xs text-fiber-gray mt-1">PNG, JPG hasta 10MB</p>
                                    </div>
                                    <div id="uploadedFile" class="hidden">
                                        <div class="flex items-center justify-center space-x-2">
                                            <svg class="w-6 h-6 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"/>
                                            </svg>
                                            <span class="text-green-600 font-medium">Archivo cargado exitosamente</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4">
                                <button type="button" onclick="resetForm()" 
                                        class="px-6 py-3 border border-gray-300 text-fiber-gray rounded-lg hover:bg-gray-50 transition-colors">
                                    Limpiar
                                </button>
                                <button type="submit" 
                                        class="px-6 py-3 bg-fiber-blue hover:bg-blue-700 text-white rounded-lg transition-colors">
                                    Enviar Registro
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Admin Panel -->
                <div id="adminSection" class="section" style="display: none;">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-fiber-dark">Panel de Administración</h2>
                        <p class="text-fiber-gray">Gestión completa de trabajos y técnicos</p>
                    </div>
                    
                    <!-- Admin Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-xl card-shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-fiber-gray text-sm">Total Técnicos</p>
                                    <p class="text-2xl font-bold text-fiber-dark">8</p>
                                </div>
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl card-shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-fiber-gray text-sm">Proyectos Activos</p>
                                    <p class="text-2xl font-bold text-fiber-dark">12</p>
                                </div>
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                                        <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 102 0V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl card-shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-fiber-gray text-sm">Ingresos del Mes</p>
                                    <p class="text-2xl font-bold text-fiber-dark">$45,230</p>
                                </div>
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zM14 6a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2V8a2 2 0 012-2h6zM4 14a2 2 0 002 2h8a2 2 0 002-2v-2H4v2z"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl card-shadow p-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-fiber-gray text-sm">Ganancia Neta</p>
                                    <p class="text-2xl font-bold text-fiber-dark">$18,920</p>
                                </div>
                                <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-yellow-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Work Management Table -->
                    <div class="bg-white rounded-xl card-shadow">
                        <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-fiber-dark">Gestión de Trabajos</h3>
                            <div class="flex space-x-3">
                                <button onclick="assignDTAP()" class="bg-fiber-blue hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                                    Asignar DTAP
                                </button>
                                <button onclick="generateReport()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                                    Generar Reporte
                                </button>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="text-left text-fiber-gray text-sm">
                                            <th class="pb-3">ID</th>
                                            <th class="pb-3">Técnico</th>
                                            <th class="pb-3">DTAP</th>
                                            <th class="pb-3">Proyecto</th>
                                            <th class="pb-3">Estado</th>
                                            <th class="pb-3">Tarifa</th>
                                            <th class="pb-3">Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="adminWorkTable" class="text-sm">
                                        <!-- Admin work table will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- User Management -->
                <div id="usersSection" class="section" style="display: none;">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-fiber-dark">Gestión de Usuarios</h2>
                        <p class="text-fiber-gray">Administrar técnicos y administradores</p>
                    </div>
                    
                    <div class="bg-white rounded-xl card-shadow">
                        <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-fiber-dark">Lista de Usuarios</h3>
                            <button onclick="showAddUserModal()" class="bg-fiber-blue hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                                Agregar Usuario
                            </button>
                        </div>
                        <div class="p-6">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="text-left text-fiber-gray text-sm">
                                            <th class="pb-3">Usuario</th>
                                            <th class="pb-3">Nombre</th>
                                            <th class="pb-3">Rol</th>
                                            <th class="pb-3">Estado</th>
                                            <th class="pb-3">Último Acceso</th>
                                            <th class="pb-3">Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="usersTable" class="text-sm">
                                        <!-- Users table will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Payroll Section -->
                <div id="payrollSection" class="section" style="display: none;">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-fiber-dark">Gestión de Nómina</h2>
                        <p class="text-fiber-gray">Control de pagos y tarifas</p>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <!-- Payroll Summary -->
                        <div class="bg-white rounded-xl card-shadow p-6">
                            <h3 class="text-lg font-semibold text-fiber-dark mb-4">Resumen de Pagos</h3>
                            <div class="space-y-4">
                                <div class="flex justify-between items-center">
                                    <span class="text-fiber-gray">Total a Pagar Técnicos:</span>
                                    <span class="font-semibold text-fiber-dark">$26,310</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-fiber-gray">Ingresos Totales:</span>
                                    <span class="font-semibold text-fiber-dark">$45,230</span>
                                </div>
                                <div class="flex justify-between items-center border-t pt-4">
                                    <span class="text-fiber-gray font-medium">Ganancia Neta:</span>
                                    <span class="font-bold text-green-600 text-lg">$18,920</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Rate Configuration -->
                        <div class="bg-white rounded-xl card-shadow p-6">
                            <h3 class="text-lg font-semibold text-fiber-dark mb-4">Configuración de Tarifas</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-fiber-dark mb-2">Instalación Residencial</label>
                                    <div class="flex space-x-2">
                                        <input type="number" value="150" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm">
                                        <span class="px-3 py-2 bg-gray-100 rounded-lg text-sm text-fiber-gray">USD</span>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-fiber-dark mb-2">Mantenimiento</label>
                                    <div class="flex space-x-2">
                                        <input type="number" value="120" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm">
                                        <span class="px-3 py-2 bg-gray-100 rounded-lg text-sm text-fiber-gray">USD</span>
                                    </div>
                                </div>
                                <button class="w-full bg-fiber-blue hover:bg-blue-700 text-white py-2 rounded-lg text-sm transition-colors">
                                    Actualizar Tarifas
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Payroll Table -->
                    <div class="bg-white rounded-xl card-shadow">
                        <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-fiber-dark">Historial de Pagos</h3>
                            <button onclick="schedulePayment()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                                Programar Pago
                            </button>
                        </div>
                        <div class="p-6">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="text-left text-fiber-gray text-sm">
                                            <th class="pb-3">Técnico</th>
                                            <th class="pb-3">Trabajos</th>
                                            <th class="pb-3">Tarifa/Trabajo</th>
                                            <th class="pb-3">Total Ganado</th>
                                            <th class="pb-3">Estado</th>
                                            <th class="pb-3">Fecha Pago</th>
                                        </tr>
                                    </thead>
                                    <tbody id="payrollTable" class="text-sm">
                                        <!-- Payroll table will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="modalOverlay" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 w-full max-w-md mx-4">
            <div id="modalContent">
                <!-- Modal content will be inserted here -->
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentUser = null;
        let workData = [];
        let userData = [
            { username: 'admin', password: 'admin123', name: 'Administrador', role: 'admin', active: true },
            { username: 'tecnico1', password: 'tech123', name: 'Juan Pérez', role: 'technician', active: true },
            { username: 'tecnico2', password: 'tech123', name: 'María García', role: 'technician', active: true },
            { username: 'tecnico3', password: 'tech123', name: 'Carlos López', role: 'technician', active: true }
        ];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Set today's date as default
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('workDate').value = today;
            
            // Load sample data
            loadSampleData();
        });

        // Authentication
        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            const user = userData.find(u => u.username === username && u.password === password && u.active);
            
            if (user) {
                currentUser = user;
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                document.getElementById('navbar').style.display = 'block';
                document.getElementById('userWelcome').textContent = `Bienvenido, ${user.name}`;
                document.getElementById('technicianName').value = user.name;
                
                // Show admin menu if user is admin
                if (user.role === 'admin') {
                    document.getElementById('adminMenu').style.display = 'block';
                }
                
                // Load dashboard
                showSection('dashboard');
                loadDashboardData();
            } else {
                alert('Usuario o contraseña incorrectos');
            }
        }

        function logout() {
            currentUser = null;
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
            document.getElementById('navbar').style.display = 'none';
            document.getElementById('adminMenu').style.display = 'none';
            
            // Reset form
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }

        // Navigation
        function showSection(sectionName) {
            // Hide all sections
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.style.display = 'none');
            
            // Show selected section
            document.getElementById(sectionName + 'Section').style.display = 'block';
            
            // Load section-specific data
            switch(sectionName) {
                case 'dashboard':
                    loadDashboardData();
                    break;
                case 'admin':
                    loadAdminData();
                    break;
                case 'users':
                    loadUsersData();
                    break;
                case 'payroll':
                    loadPayrollData();
                    break;
            }
        }

        // Work form handling
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                // Simulate file upload to Google Drive
                setTimeout(() => {
                    document.getElementById('uploadArea').style.display = 'none';
                    document.getElementById('uploadedFile').style.display = 'block';
                }, 1000);
            }
        }

        function submitWork(event) {
            event.preventDefault();
            
            const workEntry = {
                id: 'W' + Date.now(),
                dtap: document.getElementById('dtapSelect').value,
                date: document.getElementById('workDate').value,
                technician: document.getElementById('technicianName').value,
                location: document.getElementById('location').value,
                project: document.getElementById('projectSelect').value,
                terminal: document.getElementById('terminal').value,
                status: 'Pendiente',
                evidence: document.getElementById('evidencePhoto').files[0] ? 'Evidencia_' + Date.now() + '.jpg' : null,
                submittedAt: new Date().toISOString()
            };
            
            workData.push(workEntry);
            
            // Show success message
            alert('Trabajo registrado exitosamente. ID: ' + workEntry.id);
            
            // Reset form
            resetForm();
            
            // Refresh dashboard if visible
            if (document.getElementById('dashboardSection').style.display !== 'none') {
                loadDashboardData();
            }
        }

        function resetForm() {
            document.getElementById('dtapSelect').value = '';
            document.getElementById('location').value = '';
            document.getElementById('projectSelect').value = '';
            document.getElementById('terminal').value = '';
            document.getElementById('evidencePhoto').value = '';
            document.getElementById('uploadArea').style.display = 'block';
            document.getElementById('uploadedFile').style.display = 'none';
        }

        // Dashboard functions
        function loadDashboardData() {
            const userWork = currentUser.role === 'admin' ? workData : workData.filter(w => w.technician === currentUser.name);
            
            // Update stats
            const completed = userWork.filter(w => w.status === 'Aprobado').length;
            const pending = userWork.filter(w => w.status === 'Pendiente').length;
            
            document.getElementById('completedJobs').textContent = completed;
            document.getElementById('pendingJobs').textContent = pending;
            
            // Load work history table
            const tableBody = document.getElementById('workHistoryTable');
            tableBody.innerHTML = '';
            
            userWork.slice(-10).reverse().forEach(work => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-100';
                row.innerHTML = `
                    <td class="py-3">${work.dtap}</td>
                    <td class="py-3">${new Date(work.date).toLocaleDateString()}</td>
                    <td class="py-3">${work.project}</td>
                    <td class="py-3">${work.location}</td>
                    <td class="py-3">
                        <span class="px-2 py-1 rounded-full text-xs ${getStatusClass(work.status)}">
                            ${work.status}
                        </span>
                    </td>
                    <td class="py-3">
                        ${work.evidence ? '<span class="text-green-600">✓ Disponible</span>' : '<span class="text-gray-400">Sin evidencia</span>'}
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function getStatusClass(status) {
            switch(status) {
                case 'Aprobado': return 'bg-green-100 text-green-800';
                case 'Rechazado': return 'bg-red-100 text-red-800';
                case 'En Revisión': return 'bg-yellow-100 text-yellow-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        // Admin functions
        function loadAdminData() {
            const tableBody = document.getElementById('adminWorkTable');
            tableBody.innerHTML = '';
            
            workData.forEach(work => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-100';
                row.innerHTML = `
                    <td class="py-3">${work.id}</td>
                    <td class="py-3">${work.technician}</td>
                    <td class="py-3">${work.dtap}</td>
                    <td class="py-3">${work.project}</td>
                    <td class="py-3">
                        <select onchange="updateWorkStatus('${work.id}', this.value)" class="px-2 py-1 border rounded text-sm">
                            <option value="Pendiente" ${work.status === 'Pendiente' ? 'selected' : ''}>Pendiente</option>
                            <option value="En Revisión" ${work.status === 'En Revisión' ? 'selected' : ''}>En Revisión</option>
                            <option value="Aprobado" ${work.status === 'Aprobado' ? 'selected' : ''}>Aprobado</option>
                            <option value="Rechazado" ${work.status === 'Rechazado' ? 'selected' : ''}>Rechazado</option>
                        </select>
                    </td>
                    <td class="py-3">$150</td>
                    <td class="py-3">
                        <button onclick="viewWorkDetails('${work.id}')" class="text-fiber-blue hover:text-blue-700 text-sm">
                            Ver Detalles
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function updateWorkStatus(workId, newStatus) {
            const work = workData.find(w => w.id === workId);
            if (work) {
                work.status = newStatus;
                alert(`Estado actualizado a: ${newStatus}`);
            }
        }

        function assignDTAP() {
            showModal(`
                <h3 class="text-lg font-semibold text-fiber-dark mb-4">Asignar DTAP</h3>
                <form onsubmit="handleDTAPAssignment(event)">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-fiber-dark mb-2">Técnico</label>
                            <select id="assignTechnician" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                ${userData.filter(u => u.role === 'technician').map(u => 
                                    `<option value="${u.name}">${u.name}</option>`
                                ).join('')}
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-fiber-dark mb-2">DTAP</label>
                            <select id="assignDTAP" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="DTAP-001">DTAP-001 - Instalación Residencial</option>
                                <option value="DTAP-002">DTAP-002 - Mantenimiento Empresarial</option>
                                <option value="DTAP-003">DTAP-003 - Reparación de Red</option>
                            </select>
                        </div>
                        <div class="flex justify-end space-x-3">
                            <button type="button" onclick="hideModal()" class="px-4 py-2 border border-gray-300 rounded-lg">
                                Cancelar
                            </button>
                            <button type="submit" class="px-4 py-2 bg-fiber-blue text-white rounded-lg">
                                Asignar
                            </button>
                        </div>
                    </div>
                </form>
            `);
        }

        function handleDTAPAssignment(event) {
            event.preventDefault();
            const technician = document.getElementById('assignTechnician').value;
            const dtap = document.getElementById('assignDTAP').value;
            
            alert(`DTAP ${dtap} asignado a ${technician}`);
            hideModal();
        }

        function generateReport() {
            alert('Generando reporte... Esta funcionalidad exportaría los datos a Excel/PDF');
        }

        // User management
        function loadUsersData() {
            const tableBody = document.getElementById('usersTable');
            tableBody.innerHTML = '';
            
            userData.forEach(user => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-100';
                row.innerHTML = `
                    <td class="py-3">${user.username}</td>
                    <td class="py-3">${user.name}</td>
                    <td class="py-3">
                        <span class="px-2 py-1 rounded-full text-xs ${user.role === 'admin' ? 'bg-purple-100 text-purple-800' : 'bg-blue-100 text-blue-800'}">
                            ${user.role === 'admin' ? 'Administrador' : 'Técnico'}
                        </span>
                    </td>
                    <td class="py-3">
                        <span class="px-2 py-1 rounded-full text-xs ${user.active ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${user.active ? 'Activo' : 'Inactivo'}
                        </span>
                    </td>
                    <td class="py-3">Hoy</td>
                    <td class="py-3">
                        <button onclick="editUser('${user.username}')" class="text-fiber-blue hover:text-blue-700 text-sm mr-2">
                            Editar
                        </button>
                        <button onclick="toggleUserStatus('${user.username}')" class="text-red-600 hover:text-red-700 text-sm">
                            ${user.active ? 'Desactivar' : 'Activar'}
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function showAddUserModal() {
            showModal(`
                <h3 class="text-lg font-semibold text-fiber-dark mb-4">Agregar Usuario</h3>
                <form onsubmit="handleAddUser(event)">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-fiber-dark mb-2">Nombre Completo</label>
                            <input type="text" id="newUserName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-fiber-dark mb-2">Usuario</label>
                            <input type="text" id="newUsername" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-fiber-dark mb-2">Contraseña</label>
                            <input type="password" id="newPassword" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-fiber-dark mb-2">Rol</label>
                            <select id="newUserRole" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="technician">Técnico</option>
                                <option value="admin">Administrador</option>
                            </select>
                        </div>
                        <div class="flex justify-end space-x-3">
                            <button type="button" onclick="hideModal()" class="px-4 py-2 border border-gray-300 rounded-lg">
                                Cancelar
                            </button>
                            <button type="submit" class="px-4 py-2 bg-fiber-blue text-white rounded-lg">
                                Crear Usuario
                            </button>
                        </div>
                    </div>
                </form>
            `);
        }

        function handleAddUser(event) {
            event.preventDefault();
            const newUser = {
                username: document.getElementById('newUsername').value,
                password: document.getElementById('newPassword').value,
                name: document.getElementById('newUserName').value,
                role: document.getElementById('newUserRole').value,
                active: true
            };
            
            userData.push(newUser);
            alert('Usuario creado exitosamente');
            hideModal();
            loadUsersData();
        }

        function toggleUserStatus(username) {
            const user = userData.find(u => u.username === username);
            if (user) {
                user.active = !user.active;
                loadUsersData();
            }
        }

        // Payroll functions
        function loadPayrollData() {
            const tableBody = document.getElementById('payrollTable');
            tableBody.innerHTML = '';
            
            const technicians = userData.filter(u => u.role === 'technician');
            
            technicians.forEach(tech => {
                const techWork = workData.filter(w => w.technician === tech.name && w.status === 'Aprobado');
                const totalEarned = techWork.length * 150; // $150 per job
                
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-100';
                row.innerHTML = `
                    <td class="py-3">${tech.name}</td>
                    <td class="py-3">${techWork.length}</td>
                    <td class="py-3">$150</td>
                    <td class="py-3 font-semibold">$${totalEarned}</td>
                    <td class="py-3">
                        <span class="px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800">
                            Pendiente
                        </span>
                    </td>
                    <td class="py-3">15/12/2024</td>
                `;
                tableBody.appendChild(row);
            });
        }

        function schedulePayment() {
            alert('Funcionalidad de programación de pagos - Se integraría con sistema de pagos');
        }

        // Modal functions
        function showModal(content) {
            document.getElementById('modalContent').innerHTML = content;
            document.getElementById('modalOverlay').classList.remove('hidden');
            document.getElementById('modalOverlay').classList.add('flex');
        }

        function hideModal() {
            document.getElementById('modalOverlay').classList.add('hidden');
            document.getElementById('modalOverlay').classList.remove('flex');
        }

        // Sample data loader
        function loadSampleData() {
            // Add some sample work entries
            workData = [
                {
                    id: 'W001',
                    dtap: 'DTAP-001',
                    date: '2024-12-10',
                    technician: 'Juan Pérez',
                    location: 'Av. Principal 123, Caracas',
                    project: 'Proyecto Alpha',
                    terminal: 'TML-A001',
                    status: 'Aprobado',
                    evidence: 'evidencia_001.jpg',
                    submittedAt: '2024-12-10T10:30:00Z'
                },
                {
                    id: 'W002',
                    dtap: 'DTAP-002',
                    date: '2024-12-11',
                    technician: 'María García',
                    location: 'Calle 5 con Carrera 10, Valencia',
                    project: 'Proyecto Beta',
                    terminal: 'TML-B002',
                    status: 'En Revisión',
                    evidence: 'evidencia_002.jpg',
                    submittedAt: '2024-12-11T14:15:00Z'
                },
                {
                    id: 'W003',
                    dtap: 'DTAP-003',
                    date: '2024-12-12',
                    technician: 'Carlos López',
                    location: 'Zona Industrial, Maracay',
                    project: 'Proyecto Gamma',
                    terminal: 'TML-C003',
                    status: 'Pendiente',
                    evidence: 'evidencia_003.jpg',
                    submittedAt: '2024-12-12T09:45:00Z'
                }
            ];
        }

        // Utility functions
        function viewWorkDetails(workId) {
            const work = workData.find(w => w.id === workId);
            if (work) {
                showModal(`
                    <h3 class="text-lg font-semibold text-fiber-dark mb-4">Detalles del Trabajo</h3>
                    <div class="space-y-3">
                        <div><strong>ID:</strong> ${work.id}</div>
                        <div><strong>DTAP:</strong> ${work.dtap}</div>
                        <div><strong>Técnico:</strong> ${work.technician}</div>
                        <div><strong>Fecha:</strong> ${new Date(work.date).toLocaleDateString()}</div>
                        <div><strong>Ubicación:</strong> ${work.location}</div>
                        <div><strong>Proyecto:</strong> ${work.project}</div>
                        <div><strong>Terminal:</strong> ${work.terminal}</div>
                        <div><strong>Estado:</strong> ${work.status}</div>
                        <div><strong>Evidencia:</strong> ${work.evidence || 'No disponible'}</div>
                    </div>
                    <div class="mt-6 flex justify-end">
                        <button onclick="hideModal()" class="px-4 py-2 bg-fiber-blue text-white rounded-lg">
                            Cerrar
                        </button>
                    </div>
                `);
            }
        }

        // Close modal when clicking outside
        document.getElementById('modalOverlay').addEventListener('click', function(e) {
            if (e.target === this) {
                hideModal();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'967f4a9bd646cedc',t:'MTc1Mzk4NzkzMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
